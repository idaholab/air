///////////////////////////////////////////////////////////////////////////
// LibSBTL_vu_AIR - SBTL library for (gaseous) air based on:
//
// Lemmon, E.W., Jacobsen, R.T, Penoncello, S.G., and Friend, D.G.:
//
//   "Thermodynamic Properties of Air and Mixtures of Nitrogen, Argon, and Oxygen from 60 to 2000 K at Pressures to 2000 MPa,"
//   J. Phys. Chem. Ref. Data, 29(3):331-385, 2000. doi: 10.1063/1.1285884
//
// Lemmon, E.W. and Jacobsen, R.T.:
//
//   "Viscosity and Thermal Conductivity Equations for Nitrogen, Oxygen, Argon, and Air,"
//   Int. J. Thermophys., 25:21-69, 2004.
//
// Copyright (C) Idaho National Laboratory.
// All rights reserved.
//
// Disclaimer:
// The Idaho National Laboratory (INL) uses its best efforts to deliver a high-quality software and to verify that the computed information is correct.
// However, INL makes no warranties to that effect, and INL shall not be liable for any damage that may result from errors or omissions in the software.
//
// Version: 0.9.0
//
// VU_AIR.h
//
#include "math.h"
#include "SBTL_call_conv.h"
#include "SBTL_def.h"
//
extern const double x1_VUAIR[];
extern const double x2_VUAIR[];
//extern const double x1_RS_VUAIR[];
extern const double x2_RS_VUAIR[];
//
void IJ_VU_AIR(double v, double u, unsigned int& i, unsigned int& j, double& dx1, double& dx2) throw()
{
    double x1t,x1f,x2f;

    static const double x1_sub_RS_0=-6.530209173969;
    static const double x1_sub_RS_1=-4.6148437487418;
    static const double ZS_1=-4.5769784020477;
    static const double dist_x1_inv_0=51.68726484047;
    static const double dist_x1_inv_1=17.735663733023;
    static const double x2_sub_RS_0=-210.39742713568;
    static const double dist_x2_inv_0=0.20777691233067;
//
// transformations
    x1t=log(v);
//
    if(x1t>ZS_1) {
        x1f=(x1t-ZS_1)*dist_x1_inv_1;
        i=IROUND(x1f)+100;
        if(i>298) i=298;
    } else if(x1t<x1_sub_RS_1) {
        x1f=(x1t-x1_sub_RS_0)*dist_x1_inv_0;
        if(x1f>0.) i=IROUND(x1f);
        else i=0;
    } else {
        i=99;
    }
//
    x2f=(u-x2_sub_RS_0)*dist_x2_inv_0;
    if(x2f>0.) {
        j=IROUND(x2f);
        if(j>199) j=199;
    } else j=0;
//
    dx1=x1t-x1_VUAIR[i];
    dx2=u-x2_VUAIR[j];
}
//
void IJ_VU_AIR_T(double vt, double u, unsigned int& i, unsigned int& j, double& dx1, double& dx2) throw()
{
    double x1f,x2f;

    static const double x1_sub_RS_0=-6.530209173969;
    static const double x1_sub_RS_1=-4.6148437487418;
    static const double ZS_1=-4.5769784020477;
    static const double dist_x1_inv_0=51.68726484047;
    static const double dist_x1_inv_1=17.735663733023;
    static const double x2_sub_RS_0=-210.39742713568;
    static const double dist_x2_inv_0=0.20777691233067;
//
    if(vt>ZS_1) {
        x1f=(vt-ZS_1)*dist_x1_inv_1;
        i=IROUND(x1f)+100;
        if(i>298) i=298;
    } else if(vt<x1_sub_RS_1) {
        x1f=(vt-x1_sub_RS_0)*dist_x1_inv_0;
        if(x1f>0.) i=IROUND(x1f);
        else i=0;
    } else {
        i=99;
    }
//
    x2f=(u-x2_sub_RS_0)*dist_x2_inv_0;
    if(x2f>0.) {
        j=IROUND(x2f);
        if(j>199) j=199;
    } else j=0;
//
    dx1=vt-x1_VUAIR[i];
    dx2=u-x2_VUAIR[j];
}
//
//
const double x1_VUAIR[299] = {
    -6.5205356112153,-6.501188485708,-6.4818413602006,-6.4624942346933,-6.4431471091859,-6.4237999836786,-6.4044528581712,-6.3851057326639,-6.3657586071566,-6.3464114816492,
    -6.3270643561419,-6.3077172306345,-6.2883701051272,-6.2690229796198,-6.2496758541125,-6.2303287286051,-6.2109816030978,-6.1916344775904,-6.1722873520831,-6.1529402265758,
    -6.1335931010684,-6.1142459755611,-6.0948988500537,-6.0755517245464,-6.056204599039,-6.0368574735317,-6.0175103480243,-5.998163222517,-5.9788160970096,-5.9594689715023,
    -5.9401218459949,-5.9207747204876,-5.9014275949803,-5.8820804694729,-5.8627333439656,-5.8433862184582,-5.8240390929509,-5.8046919674435,-5.7853448419362,-5.7659977164288,
    -5.7466505909215,-5.7273034654141,-5.7079563399068,-5.6886092143995,-5.6692620888921,-5.6499149633848,-5.6305678378774,-5.6112207123701,-5.5918735868627,-5.5725264613554,
    -5.553179335848,-5.5338322103407,-5.5144850848333,-5.495137959326,-5.4757908338187,-5.4564437083113,-5.437096582804,-5.4177494572966,-5.3984023317893,-5.3790552062819,
    -5.3597080807746,-5.3403609552672,-5.3210138297599,-5.3016667042525,-5.2823195787452,-5.2629724532378,-5.2436253277305,-5.2242782022232,-5.2049310767158,-5.1855839512085,
    -5.1662368257011,-5.1468897001938,-5.1275425746864,-5.1081954491791,-5.0888483236717,-5.0695011981644,-5.050154072657,-5.0308069471497,-5.0114598216424,-4.992112696135,
    -4.9727655706277,-4.9534184451203,-4.934071319613,-4.9147241941056,-4.8953770685983,-4.8760299430909,-4.8566828175836,-4.8373356920762,-4.8179885665689,-4.7986414410615,
    -4.7792943155542,-4.7599471900469,-4.7406000645395,-4.7212529390322,-4.7019058135248,-4.6825586880175,-4.6632115625101,-4.6438644370028,-4.6245173114954,-4.6051701859881,
    -4.5487866181074,-4.4924030502267,-4.436019482346,-4.3796359144653,-4.3232523465846,-4.2668687787039,-4.2104852108232,-4.1541016429426,-4.0977180750619,-4.0413345071812,
    -3.9849509393005,-3.9285673714198,-3.8721838035391,-3.8158002356584,-3.7594166677777,-3.703033099897,-3.6466495320163,-3.5902659641356,-3.5338823962549,-3.4774988283743,
    -3.4211152604936,-3.3647316926129,-3.3083481247322,-3.2519645568515,-3.1955809889708,-3.1391974210901,-3.0828138532094,-3.0264302853287,-2.970046717448,-2.9136631495673,
    -2.8572795816866,-2.800896013806,-2.7445124459253,-2.6881288780446,-2.6317453101639,-2.5753617422832,-2.5189781744025,-2.4625946065218,-2.4062110386411,-2.3498274707604,
    -2.2934439028797,-2.237060334999,-2.1806767671183,-2.1242931992376,-2.067909631357,-2.0115260634763,-1.9551424955956,-1.8987589277149,-1.8423753598342,-1.7859917919535,
    -1.7296082240728,-1.6732246561921,-1.6168410883114,-1.5604575204307,-1.50407395255,-1.4476903846693,-1.3913068167887,-1.334923248908,-1.2785396810273,-1.2221561131466,
    -1.1657725452659,-1.1093889773852,-1.0530054095045,-0.99662184162381,-0.94023827374312,-0.88385470586242,-0.82747113798173,-0.77108757010104,-0.71470400222035,-0.65832043433966,
    -0.60193686645897,-0.54555329857827,-0.48916973069758,-0.43278616281689,-0.3764025949362,-0.32001902705551,-0.26363545917481,-0.20725189129412,-0.15086832341343,-9.4484755532738e-002,
    -3.8101187652046e-002,1.8282380228646e-002,7.4665948109337e-002,0.13104951599003,0.18743308387072,0.24381665175141,0.30020021963211,0.3565837875128,0.41296735539349,0.46935092327418,
    0.52573449115487,0.58211805903557,0.63850162691626,0.69488519479695,0.75126876267764,0.80765233055833,0.86403589843902,0.92041946631972,0.97680303420041,1.0331866020811,
    1.0895701699618,1.1459537378425,1.2023373057232,1.2587208736039,1.3151044414846,1.3714880093653,1.4278715772459,1.4842551451266,1.5406387130073,1.597022280888,
    1.6534058487687,1.7097894166494,1.7661729845301,1.8225565524108,1.8789401202915,1.9353236881722,1.9917072560529,2.0480908239336,2.1044743918142,2.1608579596949,
    2.2172415275756,2.2736250954563,2.330008663337,2.3863922312177,2.4427757990984,2.4991593669791,2.5555429348598,2.6119265027405,2.6683100706212,2.7246936385019,
    2.7810772063825,2.8374607742632,2.8938443421439,2.9502279100246,3.0066114779053,3.062995045786,3.1193786136667,3.1757621815474,3.2321457494281,3.2885293173088,
    3.3449128851895,3.4012964530702,3.4576800209509,3.5140635888315,3.5704471567122,3.6268307245929,3.6832142924736,3.7395978603543,3.795981428235,3.8523649961157,
    3.9087485639964,3.9651321318771,4.0215156997578,4.0778992676385,4.1342828355192,4.1906664033998,4.2470499712805,4.3034335391612,4.3598171070419,4.4162006749226,
    4.4725842428033,4.528967810684,4.5853513785647,4.6417349464454,4.6981185143261,4.7545020822068,4.8108856500875,4.8672692179681,4.9236527858488,4.9800363537295,
    5.0364199216102,5.0928034894909,5.1491870573716,5.2055706252523,5.261954193133,5.3183377610137,5.3747213288944,5.4311048967751,5.4874884646558,5.5438720325365,
    5.6002556004171,5.6566391682978,5.7130227361785,5.7694063040592,5.8257898719399,5.8821734398206,5.9385570077013,5.994940575582,6.0513241434627,6.1077077113434,
    6.1640912792241,6.2204748471048,6.2768584149854,6.3332419828661,6.3896255507468,6.4460091186275,6.5023926865082,6.5587762543889,6.6151598222696
};
/*
const double x1_RS_VUAIR[300] = {
    -6.530209173969,-6.5108620484617,-6.4915149229543,-6.472167797447,-6.4528206719396,-6.4334735464323,-6.4141264209249,-6.3947792954176,-6.3754321699102,-6.3560850444029,
    -6.3367379188955,-6.3173907933882,-6.2980436678808,-6.2786965423735,-6.2593494168662,-6.2400022913588,-6.2206551658515,-6.2013080403441,-6.1819609148368,-6.1626137893294,
    -6.1432666638221,-6.1239195383147,-6.1045724128074,-6.0852252873,-6.0658781617927,-6.0465310362854,-6.027183910778,-6.0078367852707,-5.9884896597633,-5.969142534256,
    -5.9497954087486,-5.9304482832413,-5.9111011577339,-5.8917540322266,-5.8724069067192,-5.8530597812119,-5.8337126557045,-5.8143655301972,-5.7950184046899,-5.7756712791825,
    -5.7563241536752,-5.7369770281678,-5.7176299026605,-5.6982827771531,-5.6789356516458,-5.6595885261384,-5.6402414006311,-5.6208942751237,-5.6015471496164,-5.5822000241091,
    -5.5628528986017,-5.5435057730944,-5.524158647587,-5.5048115220797,-5.4854643965723,-5.466117271065,-5.4467701455576,-5.4274230200503,-5.4080758945429,-5.3887287690356,
    -5.3693816435282,-5.3500345180209,-5.3306873925136,-5.3113402670062,-5.2919931414989,-5.2726460159915,-5.2532988904842,-5.2339517649768,-5.2146046394695,-5.1952575139621,
    -5.1759103884548,-5.1565632629474,-5.1372161374401,-5.1178690119328,-5.0985218864254,-5.0791747609181,-5.0598276354107,-5.0404805099034,-5.021133384396,-5.0017862588887,
    -4.9824391333813,-4.963092007874,-4.9437448823666,-4.9243977568593,-4.905050631352,-4.8857035058446,-4.8663563803373,-4.8470092548299,-4.8276621293226,-4.8083150038152,
    -4.7889678783079,-4.7696207528005,-4.7502736272932,-4.7309265017858,-4.7115793762785,-4.6922322507711,-4.6728851252638,-4.6535379997565,-4.6341908742491,-4.6148437487418,
    -4.5769784020477,-4.5205948341671,-4.4642112662864,-4.4078276984057,-4.351444130525,-4.2950605626443,-4.2386769947636,-4.1822934268829,-4.1259098590022,-4.0695262911215,
    -4.0131427232408,-3.9567591553601,-3.9003755874794,-3.8439920195988,-3.7876084517181,-3.7312248838374,-3.6748413159567,-3.618457748076,-3.5620741801953,-3.5056906123146,
    -3.4493070444339,-3.3929234765532,-3.3365399086725,-3.2801563407918,-3.2237727729111,-3.1673892050304,-3.1110056371498,-3.0546220692691,-2.9982385013884,-2.9418549335077,
    -2.885471365627,-2.8290877977463,-2.7727042298656,-2.7163206619849,-2.6599370941042,-2.6035535262235,-2.5471699583428,-2.4907863904621,-2.4344028225815,-2.3780192547008,
    -2.3216356868201,-2.2652521189394,-2.2088685510587,-2.152484983178,-2.0961014152973,-2.0397178474166,-1.9833342795359,-1.9269507116552,-1.8705671437745,-1.8141835758938,
    -1.7578000080131,-1.7014164401325,-1.6450328722518,-1.5886493043711,-1.5322657364904,-1.4758821686097,-1.419498600729,-1.3631150328483,-1.3067314649676,-1.2503478970869,
    -1.1939643292062,-1.1375807613255,-1.0811971934448,-1.0248136255642,-0.96843005768346,-0.91204648980277,-0.85566292192208,-0.79927935404139,-0.7428957861607,-0.68651221828,
    -0.63012865039931,-0.57374508251862,-0.51736151463793,-0.46097794675724,-0.40459437887654,-0.34821081099585,-0.29182724311516,-0.23544367523447,-0.17906010735378,-0.12267653947308,
    -6.6292971592392e-002,-9.9094037117e-003,4.6474164168992e-002,0.10285773204968,0.15924129993038,0.21562486781107,0.27200843569176,0.32839200357245,0.38477557145314,0.44115913933383,
    0.49754270721453,0.55392627509522,0.61030984297591,0.6666934108566,0.72307697873729,0.77946054661799,0.83584411449868,0.89222768237937,0.94861125026006,1.0049948181408,
    1.0613783860214,1.1177619539021,1.1741455217828,1.2305290896635,1.2869126575442,1.3432962254249,1.3996797933056,1.4560633611863,1.512446929067,1.5688304969477,
    1.6252140648284,1.6815976327091,1.7379812005897,1.7943647684704,1.8507483363511,1.9071319042318,1.9635154721125,2.0198990399932,2.0762826078739,2.1326661757546,
    2.1890497436353,2.245433311516,2.3018168793967,2.3582004472774,2.4145840151581,2.4709675830387,2.5273511509194,2.5837347188001,2.6401182866808,2.6965018545615,
    2.7528854224422,2.8092689903229,2.8656525582036,2.9220361260843,2.978419693965,3.0348032618457,3.0911868297264,3.147570397607,3.2039539654877,3.2603375333684,
    3.3167211012491,3.3731046691298,3.4294882370105,3.4858718048912,3.5422553727719,3.5986389406526,3.6550225085333,3.711406076414,3.7677896442947,3.8241732121753,
    3.880556780056,3.9369403479367,3.9933239158174,4.0497074836981,4.1060910515788,4.1624746194595,4.2188581873402,4.2752417552209,4.3316253231016,4.3880088909823,
    4.444392458863,4.5007760267437,4.5571595946243,4.613543162505,4.6699267303857,4.7263102982664,4.7826938661471,4.8390774340278,4.8954610019085,4.9518445697892,
    5.0082281376699,5.0646117055506,5.1209952734313,5.177378841312,5.2337624091926,5.2901459770733,5.346529544954,5.4029131128347,5.4592966807154,5.5156802485961,
    5.5720638164768,5.6284473843575,5.6848309522382,5.7412145201189,5.7975980879996,5.8539816558803,5.9103652237609,5.9667487916416,6.0231323595223,6.079515927403,
    6.1358994952837,6.1922830631644,6.2486666310451,6.3050501989258,6.3614337668065,6.4178173346872,6.4742009025679,6.5305844704486,6.5869680383293,6.6433516062099
};
*/
const double x2_VUAIR[200] = {
    -207.991,-203.17814572864,-198.36529145729,-193.55243718593,-188.73958291457,-183.92672864322,-179.11387437186,-174.3010201005,-169.48816582915,-164.67531155779,
    -159.86245728643,-155.04960301508,-150.23674874372,-145.42389447236,-140.61104020101,-135.79818592965,-130.98533165829,-126.17247738693,-121.35962311558,-116.54676884422,
    -111.73391457286,-106.92106030151,-102.10820603015,-97.295351758794,-92.482497487437,-87.66964321608,-82.856788944724,-78.043934673367,-73.23108040201,-68.418226130653,
    -63.605371859296,-58.79251758794,-53.979663316583,-49.166809045226,-44.353954773869,-39.541100502513,-34.728246231156,-29.915391959799,-25.102537688442,-20.289683417085,
    -15.476829145729,-10.663974874372,-5.8511206030151,-1.0382663316583,3.7745879396985,8.5874422110553,13.400296482412,18.213150753769,23.026005025126,27.838859296482,
    32.651713567839,37.464567839196,42.277422110553,47.09027638191,51.903130653266,56.715984924623,61.52883919598,66.341693467337,71.154547738693,75.96740201005,
    80.780256281407,85.593110552764,90.405964824121,95.218819095477,100.03167336683,104.84452763819,109.65738190955,114.4702361809,119.28309045226,124.09594472362,
    128.90879899497,133.72165326633,138.53450753769,143.34736180905,148.1602160804,152.97307035176,157.78592462312,162.59877889447,167.41163316583,172.22448743719,
    177.03734170854,181.8501959799,186.66305025126,191.47590452261,196.28875879397,201.10161306533,205.91446733668,210.72732160804,215.5401758794,220.35303015075,
    225.16588442211,229.97873869347,234.79159296482,239.60444723618,244.41730150754,249.23015577889,254.04301005025,258.85586432161,263.66871859296,268.48157286432,
    273.29442713568,278.10728140704,282.92013567839,287.73298994975,292.54584422111,297.35869849246,302.17155276382,306.98440703518,311.79726130653,316.61011557789,
    321.42296984925,326.2358241206,331.04867839196,335.86153266332,340.67438693467,345.48724120603,350.30009547739,355.11294974874,359.9258040201,364.73865829146,
    369.55151256281,374.36436683417,379.17722110553,383.99007537688,388.80292964824,393.6157839196,398.42863819095,403.24149246231,408.05434673367,412.86720100503,
    417.68005527638,422.49290954774,427.3057638191,432.11861809045,436.93147236181,441.74432663317,446.55718090452,451.37003517588,456.18288944724,460.99574371859,
    465.80859798995,470.62145226131,475.43430653266,480.24716080402,485.06001507538,489.87286934673,494.68572361809,499.49857788945,504.3114321608,509.12428643216,
    513.93714070352,518.74999497487,523.56284924623,528.37570351759,533.18855778894,538.0014120603,542.81426633166,547.62712060302,552.43997487437,557.25282914573,
    562.06568341709,566.87853768844,571.6913919598,576.50424623116,581.31710050251,586.12995477387,590.94280904523,595.75566331658,600.56851758794,605.3813718593,
    610.19422613065,615.00708040201,619.81993467337,624.63278894472,629.44564321608,634.25849748744,639.07135175879,643.88420603015,648.69706030151,653.50991457286,
    658.32276884422,663.13562311558,667.94847738693,672.76133165829,677.57418592965,682.387040201,687.19989447236,692.01274874372,696.82560301508,701.63845728643,
    706.45131155779,711.26416582915,716.0770201005,720.88987437186,725.70272864322,730.51558291457,735.32843718593,740.14129145729,744.95414572864,749.767
};
//
const double x2_RS_VUAIR[201] = {
    -210.39742713568,-205.58457286432,-200.77171859296,-195.95886432161,-191.14601005025,-186.33315577889,-181.52030150754,-176.70744723618,-171.89459296482,-167.08173869347,
    -162.26888442211,-157.45603015075,-152.6431758794,-147.83032160804,-143.01746733668,-138.20461306533,-133.39175879397,-128.57890452261,-123.76605025126,-118.9531959799,
    -114.14034170854,-109.32748743719,-104.51463316583,-99.701778894472,-94.888924623116,-90.076070351759,-85.263216080402,-80.450361809045,-75.637507537688,-70.824653266332,
    -66.011798994975,-61.198944723618,-56.386090452261,-51.573236180905,-46.760381909548,-41.947527638191,-37.134673366834,-32.321819095477,-27.508964824121,-22.696110552764,
    -17.883256281407,-13.07040201005,-8.2575477386935,-3.4446934673367,1.3681608040201,6.1810150753769,10.993869346734,15.80672361809,20.619577889447,25.432432160804,
    30.245286432161,35.058140703518,39.870994974874,44.683849246231,49.496703517588,54.309557788945,59.122412060301,63.935266331658,68.748120603015,73.560974874372,
    78.373829145729,83.186683417085,87.999537688442,92.812391959799,97.625246231156,102.43810050251,107.25095477387,112.06380904523,116.87666331658,121.68951758794,
    126.5023718593,131.31522613065,136.12808040201,140.94093467337,145.75378894472,150.56664321608,155.37949748744,160.19235175879,165.00520603015,169.81806030151,
    174.63091457286,179.44376884422,184.25662311558,189.06947738693,193.88233165829,198.69518592965,203.50804020101,208.32089447236,213.13374874372,217.94660301508,
    222.75945728643,227.57231155779,232.38516582915,237.1980201005,242.01087437186,246.82372864322,251.63658291457,256.44943718593,261.26229145729,266.07514572864,
    270.888,275.70085427136,280.51370854271,285.32656281407,290.13941708543,294.95227135678,299.76512562814,304.5779798995,309.39083417085,314.20368844221,
    319.01654271357,323.82939698492,328.64225125628,333.45510552764,338.26795979899,343.08081407035,347.89366834171,352.70652261307,357.51937688442,362.33223115578,
    367.14508542714,371.95793969849,376.77079396985,381.58364824121,386.39650251256,391.20935678392,396.02221105528,400.83506532663,405.64791959799,410.46077386935,
    415.2736281407,420.08648241206,424.89933668342,429.71219095477,434.52504522613,439.33789949749,444.15075376884,448.9636080402,453.77646231156,458.58931658291,
    463.40217085427,468.21502512563,473.02787939698,477.84073366834,482.6535879397,487.46644221106,492.27929648241,497.09215075377,501.90500502513,506.71785929648,
    511.53071356784,516.3435678392,521.15642211055,525.96927638191,530.78213065327,535.59498492462,540.40783919598,545.22069346734,550.03354773869,554.84640201005,
    559.65925628141,564.47211055276,569.28496482412,574.09781909548,578.91067336683,583.72352763819,588.53638190955,593.3492361809,598.16209045226,602.97494472362,
    607.78779899497,612.60065326633,617.41350753769,622.22636180905,627.0392160804,631.85207035176,636.66492462312,641.47777889447,646.29063316583,651.10348743719,
    655.91634170854,660.7291959799,665.54205025126,670.35490452261,675.16775879397,679.98061306533,684.79346733668,689.60632160804,694.4191758794,699.23203015075,
    704.04488442211,708.85773869347,713.67059296482,718.48344723618,723.29630150754,728.10915577889,732.92201005025,737.73486432161,742.54771859296,747.36057286432,
    752.17342713568
};
//